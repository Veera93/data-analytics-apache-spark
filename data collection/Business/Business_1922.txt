 The overhaul by Republican lawmakers of the nation’s tax laws percolated for weeks with virtually no public input, and by the end it turned into a chaotic mad dash with many last-minute changes on Friday night and Saturday morning, some handwritten in the margins of the nearly 500-page bill. Even hours after the Senate vote, tax experts were scratching their heads over precisely what had made it into the final version of the bill and the impact of some significant provisions. Still, it was clear that many changes expanded tax benefits for the wealthiest taxpayers, while other attempts to close loopholes fell by the wayside. The bill would add $1 trillion to deficits over the coming decade. Far from simplifying taxes, the bill opened up a whole range of tactics to lower the amount owed to the Internal Revenue Service. “Business owners or managers that plan well and pay for good advice will be able to achieve much more favorable rates,” said Adam Looney, a senior fellow at the Brookings Institution and a former Treasury Department official. “I’m not sure if that is a loophole or the intent of the legislation.” One of the bill’s biggest windfalls for the wealthy — cutting taxes on income received through so-called pass-through entities like partnerships, popular with real estate developers — got even more generous. The richest taxpayers will be taxed at a rate of about 29.6 percent on such income, a big cut from the current top federal income tax rate of 39.6. The ever-lengthening list of income that will be taxed at a cut-rate could be seen as “a Donald J. Trump loophole,” said Steven M. Rosenthal of the nonpartisan Tax Policy Center. A large amount of that kind of income is on Mr. Trump’s 2005 tax return, two pages of which became public in March, and on his 2017 financial disclosure forms, which show more than 500 pass-through entities, Mr. Rosenthal said. That expansion would cost the government $114 billion more than an earlier version of the proposal. The provision would lower rates for taxpayers simply if their businesses are organized as partnerships or other entities whose tax burdens flow to the individual. Half of that type of income goes to the top 1 percent of taxpayers, according to the Tax Policy Center. In total, that tax cut will cost the government about $476 billion over the coming decade. Not all types of income would be eligible for the newly reduced rate. Short-term capital gains, dividends, interest and annuity payments, for example, are excluded. But the list of earnings that do qualify was expanded from earlier Republican proposals in the Senate. Investments in mortgages held by real estate investment trusts would be able to take advantage of the lower pass-through rate instead of being taxed at ordinary income rates, which are higher. Thanks to an amendment offered by Senator John Cornyn, Republican of Texas, certain income from gas and oil operators could also qualify for the new, lower rate. Industry representatives said they would have been excluded from the intended benefits that the real estate investment trusts and other publicly traded industries were getting. “The Senate went out of its way to confirm that passive investors in these publicly traded investment vehicles get the benefit of the pass-through discount tax rate,” said Edward D. Kleinbard, a professor of tax law at the University of Southern California and a former chief of staff for the congressional Joint Committee on Taxation. “This is a working definition of a tax boondoggle.” A provision to give multinational companies like Pfizer, Google and Apple a tax break on the profits they have accumulated in offshore tax havens was made less generous than earlier versions of the proposal. But the companies would still bring those earnings home at rates of 7.5 to 14.5 percent — well below the existing corporate income tax rate of 35 percent and also lower than the new corporate income tax rate, which the bill would cut nearly in half to 20 percent. This break will still save the companies roughly half a trillion dollars compared with current law, according to an estimate by the Zion Research Group. Banks and other financial institutions will still be able to avoid taxes by making payments to offshore subsidiaries. The lawmakers had initially intended to prevent the tax benefits from such actions, but the banks got a last-minute reprieve for some transactions. In calculating the companies’ tax bills, the bill excludes payments related to derivatives, a big source of income for financial institutions. Some last-minute changes were smaller and more peculiar: The bill includes limits on how much interest companies can deduct from their taxes, but excludes from those restrictions interest paid by car dealerships. The bill extends so-called bonus depreciation — the ability to take big deductions related to certain corporate investments — at a cost of $34 billion, but pays for it by reinstating the corporate alternative minimum tax. The last-minute decision to scrap the repeal of the corporate alternative minimum tax left lawyers and accountants scratching their heads about the ultimate impact. Several experts said it appeared unintentional that the benefit of the tax credit for research and experimentation could effectively be lost. The provision is dear to many businesses. “Oops,” said Mr. Looney of the Brookings Institution. “That’s an easy mistake to make on a first pass, but which you’d catch if you had more time.” At least one Republican proposal floated for weeks made it into the final bill, but seemingly in a form designed to punish taxpayers in Democratic states. Senator Deb Fischer, Republican of Nebraska, introduced an employee credit for paid family and medical leave. But the final version doesn’t apply to employers in states where such paid leave is either required — or will soon be required — by state law, as in New York, California, New Jersey and Rhode Island. It also doesn’t apply to employees making more than $72,000 and will last only until the end of 2019. “So in sum, we’ve got a short-term fertility incentive for lower/middle-income employees, as long as you don’t live in too blue a state,” Daniel Hemel, a professor of tax law at the University of Chicago, wrote on Twitter. While wealthy investors and business would receive numerous tax cuts — including eliminating the estate tax for all but a tiny sliver of the country’s wealthiest households — the Senate moved to tighten deductions for lower- and middle-income wage earners. The bill, for example, prohibits employers from rewarding employees with gift cards so that a reward of, say, $25 or $50 in the form of a gift card doesn’t escape being taxed. At the same time, a provision to fund the I.R.S. so that it could offer advice to low-income filers was rejected in the final bill. Although the bill expands the child tax credit by a year to 17-year-olds, that change ends at the end of 2024, a year before other individual tax cuts are scheduled to expire — so families with children born in 2008 will see that credit end when their children are still 16. In the early morning hours on Saturday, Vice President Mike Pence cast a tiebreaking vote to pass an amendment to allow people to use up to $10,000 a year from tax-advantaged 529 savings accounts for private and religious schools and some home schooling. Under current law, 529 accounts can be used only for higher education.