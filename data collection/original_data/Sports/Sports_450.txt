 INDIAN WELLS, Calif. — Since upsetting Rafael Nadal and Roger Federer to win the United States Open at the precocious age of 20, Juan Martín del Potro has had to wait and wait for his happy tennis endings. The cumulative effect of four wrist surgeries nearly knocked him out of the game for good. He was on the verge of retirement at the end of 2015, and when he finally did make another comeback, he could no longer drive through his once-fearsome two-handed backhand. Del Potro has persevered and conquered most of his doubts, but on Sunday, with Federer back across the net in the final of the BNP Paribas Open, del Potro had to be patient again. The match was on the big Argentine’s racket in the second-set tiebreaker, but he sent his staple shot — an inside-out forehand — into the net on match point, and Federer took the hint to force a third set. Federer, unbeaten in 2018, then served for the title himself at 5-4 in the third set with del Potro still ruing his missed match point. “I mean, it’s my shot, you know,” he said. “I never miss that forehand.” But tennis is a game of abrupt momentum shifts and tiny margins, and though del Potro has had more than his share of misfortune through the years, this turned out to be his lucky day in Indian Wells. He saved three match points to break back to 5-5, then went on to dominate the decisive tiebreaker and stop Federer’s 17-match winning streak with a 6-4, 6-7 (8), 7-6 (2) victory. “It was worth everything I’ve been through to experience this moment,” del Potro said. This was the best match of the men’s season so far and a breakthrough for the 29-year-old del Potro, who secured his first Masters 1000 title and his biggest individual victory since the United States Open in 2009. “Juan Martín was a bit better at the end,” said Federer, the defending champion who has won this tournament five times. “It was maybe a point here or there, maybe a shot, maybe a forehand, maybe a chip. So that’s how it goes. It’s unfortunate, but I’m happy for him.” Though Federer is seven years older than del Potro, they have a warm relationship off court and got to know each other better when Federer played del Potro in Argentina as part of a South American exhibition tour in 2012. They are quick to greet each other when they cross paths at tournaments, but this final still had a sharp edge, with both players barking at the chair umpire, Fergus Murphy. Del Potro cast a dark glance at his opponent after Federer pounded a short backhand directly into his body in that critical 10th game of the final set (Federer later raised his racket to apologize). For all the camaraderie in the locker room, this was pure, intense competition and also a particularly fine tennis match, filled with winners on the run, drop shots and phenomenal fast-twitch defense from Federer as he repeatedly half-volleyed del Potro’s huge shots from the baseline or closer to the net. Federer still leads head-to-head, 18-7, but del Potro is now 4-2 in finals. He also beat Federer in the quarterfinals of last year’s U.S. Open. “It was an unbelievable match in all the ways,” del Potro said of Sunday’s duel. All it lacked was a suspenseful third-set tiebreaker, but Federer’s serve unexpectedly deserted him. He made two double faults, the second to go down by 1-6. And after Federer saved a second match point, del Potro finally shut the window of opportunity for good. When Federer’s final shot landed long, del Potro struck the ball high into the stands straight off the bounce to celebrate. He then walked to the net, where the two rivals renewed their friendship with a firm handshake and an embrace. Federer, back at No. 1 at age 36, will remain on top heading into this week’s Miami Open. Del Potro is at No. 6 but is playing well enough after all his injuries and challenges to dream bigger. “I’m excited to see what’s next,” said del Potro, now on an 11-match winning streak of his own. “I’m still surprising myself, and I want to keep surprising the tennis tour.”